set(TARGET h264)
include_directories(${CMAKE_CURRENT_SOURCE_DIR})

add_library(${TARGET}
    libavcodec/avpacket.c
    libavcodec/bitstream.c
    libavcodec/cabac.c
    libavcodec/codec_desc.c
    libavcodec/error_resilience.c
    libavcodec/golomb.c
    libavcodec/h264_cabac.c
    libavcodec/h264_cavlc.c
    libavcodec/h264_direct.c
    libavcodec/h264_loopfilter.c
    libavcodec/h264_mb.c
    libavcodec/h264_loopfilter.c
    libavcodec/h264_parse.c
    libavcodec/h264_parser.c
    libavcodec/h264_picture.c
    libavcodec/h264_ps.c
    libavcodec/h264_refs.c
    libavcodec/h264_sei.c
    libavcodec/h264_slice.c
    libavcodec/h264.c
    libavcodec/h264chroma.c
    libavcodec/h264data.c
    libavcodec/h264dsp.c
    libavcodec/h264idct.c
    libavcodec/h264pred.c
    libavcodec/h264qpel.c
    libavcodec/h2645_parse.c
    libavcodec/mathtables.c
    libavcodec/me_cmp.c
    libavcodec/options.c
    libavcodec/parser.c
    libavcodec/profiles.c
    libavcodec/startcode.c
    libavcodec/pthread_frame.c
    libavcodec/pthread.c
    libavcodec/pthread_slice.c
    libavcodec/simple_idct.c
    libavcodec/utils.c
    libavcodec/videodsp.c

    libavutil/avstring.c
    libavutil/bprint.c
    libavutil/buffer.c
    libavutil/channel_layout.c
    libavutil/cpu.c
    libavutil/dict.c
    libavutil/display.c
    libavutil/error.c
    libavutil/eval.c
    libavutil/file_open.c
    libavutil/frame.c
    libavutil/imgutils.c
    libavutil/intmath.c
    libavutil/log.c
    libavutil/log2_tab.c
    libavutil/mathematics.c
    libavutil/mem.c
    libavutil/opt.c
    libavutil/parseutils.c
    libavutil/pixdesc.c
    libavutil/random_seed.c
    libavutil/rational.c
    libavutil/reverse.c
    libavutil/samplefmt.c
    libavutil/sha.c
    libavutil/stereo3d.c
    libavutil/time.c
    libavutil/utils.c)

if(MSVC)
    target_compile_options(${TARGET} PRIVATE /O2 /W0 /wd4996)
else()
    target_compile_options(${TARGET} PRIVATE -O2 -w -std=c99 -Wno-implicit-function-declaration)
endif()
